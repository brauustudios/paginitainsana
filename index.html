<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>¿Me perdonas mariana?</title>
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Delius&display=swap" rel="stylesheet">
<link rel="icon" type="image/x-icon"
        href="https://cdn.pixabay.com/photo/2017/09/23/16/33/pixel-heart-2779422_1280.png">
<style>
    :root {
      --bg1: #FFDDF4; /* Rosa muy claro */
      --bg2: #FFC4E1; /* Rosa claro */
      --accent-text: #E5005E; /* Rosa intenso para texto */
      --accent-btn: #FF3B8D; /* Rosa para botón */
      --accent-btn-hover: #FF73A7; /* Rosa más claro para hover */
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --radius: 20px;
    }

    * { box-sizing: border-box; }

    body {
      height: 100vh;
      margin: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Delius', cursive;
      background: linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 100%);
      color: #333;
      overflow: hidden;
      padding: 15px;
    }

    .card {
      width: min(500px, 95%);
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 230, 240, 0.9) 100%);
      border-radius: var(--radius);
      padding: clamp(20px, 5vw, 40px);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
    }

    h1 {
      font-family: 'Press Start 2P', cursive;
      font-size: clamp(20px, 6vw, 28px);
      color: var(--accent-text);
      margin-top: 0;
      margin-bottom: 20px;
      line-height: 1.4;
      animation: textGlow 2s ease-in-out infinite alternate;
    }

    @keyframes textGlow {
        from { text-shadow: 0 0 5px #ffc4e1; }
        to { text-shadow: 0 0 15px #ff73a7, 0 0 25px #ff3b8d; }
    }

    #catImage {
      width: clamp(150px, 40vw, 200px);
      height: auto;
      border-radius: 15px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      margin-bottom: 25px;
      transition: transform 0.5s ease;
    }
    
    #catImage:hover { transform: scale(1.05); }

    .button-container {
        display: flex;
        justify-content: center;
        gap: 15px;
        flex-wrap: wrap;
    }

    button {
      color: white;
      padding: 12px 25px;
      font-family: 'Press Start 2P', cursive;
      font-size: 14px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-transform: uppercase;
    }

    #yesButton {
      background-color: var(--accent-btn);
    }
    #yesButton:hover {
      background-color: var(--accent-btn-hover);
      transform: translateY(-3px);
    }

    #noButton {
      background-color: #ffb6c1;
      color: #333;
    }
    
    .confetti-container {
        position: absolute;
        top: 0; left: 0;
        width: 100%; height: 100%;
        pointer-events: none;
        overflow: hidden;
    }

</style>
</head>
<body>

<div class="card" id="mainCard">
    <div class="confetti-container" id="confetti"></div>
    <div id="content">
        <h1><span id="userName"></span>, <br>¿me perdonas?</h1>
        <img id="catImage" src="https://i0.wp.com/c.tenor.com/L6r2e_vpVAIAAAAM/sad-crying.gif" alt="Gatito triste">
        <div class="button-container">
            <button id="yesButton">SI</button>
            <button id="noButton">No</button>
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
    import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-database.js";

    // --- CONFIGURACIÓN DE FIREBASE ---
    const firebaseConfig = {
      apiKey: "AIzaSyDj2tNpNgiZPWtTYKotGq3ULALzJltHOKM",
      authDomain: "pagina-81a41.firebaseapp.com",
      databaseURL: "https://pagina-81a41-default-rtdb.firebaseio.com",
      projectId: "pagina-81a41",
      storageBucket: "pagina-81a41.firebasestorage.app",
      messagingSenderId: "803503362455",
      appId: "1:803503362455:web:ebf1271cf65943210174d2"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    
    // --- OBTENER NOMBRE Y REGISTRAR VISITA ---
    const userNameElement = document.getElementById('userName');
    let savedUsername = localStorage.getItem('username');

    if (savedUsername) {
        const capitalizedUsername = savedUsername.charAt(0).toUpperCase() + savedUsername.slice(1);
        userNameElement.textContent = capitalizedUsername;
    } else {
        userNameElement.textContent = "Tú"; 
    }

    async function logApologyEvent(eventType, details = {}) {
        try {
            await push(ref(db, "apology_page_events"), {
                eventType: eventType,
                visitor: savedUsername || "unknown_visitor",
                details: details,
                timestamp: new Date().toISOString()
            });
        } catch (e) {
            console.error(`Error al registrar evento:`, e);
        }
    }
    
    logApologyEvent('PAGE_VISIT');

    // --- LÓGICA DE LA PÁGINA ---
    const yesButton = document.getElementById('yesButton');
    const noButton = document.getElementById('noButton');
    const content = document.getElementById('content');
    const catImage = document.getElementById('catImage');
    const confettiLayer = document.getElementById('confetti');

    const buttonTexts = [
        "Por favor",
        "Di que si",
        "no seas malita",
        "Por fis",
        "¿Es un si?",
        "¿Ahora si?",
        "Porfaborsi?",
        "chi?",
        "yo te quiero mucho",
        "ya no te dejare picarle al no >:)",
        "weno si pero porfis",
        "perdoname andale 😢",
        "Por favor",
        "Di que si",
        "no seas malita",
        "Por fis",
        "¿Es un si?",
        "¿Ahora si?",
        "Porfaborsi?",
        "chi?",
        "yo te quiero mucho",
        "ya no te dejare picarle al no >:)",
        "weno si pero porfis",
        "perdoname andale 😢"
    ];

    let clickIndex = 0;

    noButton.addEventListener('click', function() {
        if (clickIndex < buttonTexts.length) {
            yesButton.textContent = buttonTexts[clickIndex];
            
            let currentFontSize = parseInt(window.getComputedStyle(yesButton).fontSize);
            if (currentFontSize < 30) { // Límite de tamaño para que no se salga
                yesButton.style.fontSize = (currentFontSize + 2) + 'px';
            }
            clickIndex++;
        }
        logApologyEvent('NO_BUTTON_CLICKED', { click_count: clickIndex });
    });

    yesButton.addEventListener('click', function() {
        logApologyEvent('FORGIVENESS_ACCEPTED', { after_no_clicks: clickIndex });
        
        content.innerHTML = `
            <h1>Graciasssssss Te Quiero Mucho ERMOZA BELLA BONITA <33 </h1>
            <h3>enserio te quiero muchisimo, no quiero que te enojes conmigo lindabonitahermosa tu sabes que te quiero mucho no era mi intencion hacerte sentir asi, enserio perdoname te lo pido con todo mi corazon siempre contaras conmigo, se que hice mal en decir eso pero no lo dije con esa intencion incluso estaba escribiendo un mensajito pero me detuve al ver que lo interpetraste de esa manera, no era mi intencion enserio disculpame miniña si te hice sentir mal, sabes que siempre estare para ti pase lo que pase <3 te pido una gran disculpa enserio :,( </h3>
            <img id="catImage" src="https://i.pinimg.com/736x/99/ee/89/99ee898fe84362f3d5c7f0893df8b385.jpg" alt="Gatito feliz">
        `;
        celebrate();
    });

    function celebrate() {
        for (let i = 0; i < 80; i++) {
            const el = document.createElement('div');
            el.style.position = 'absolute';
            el.style.left = `${Math.random() * 100}%`;
            el.style.top = `${Math.random() * 100}%`;
            el.style.width = el.style.height = `${Math.random() * 8 + 6}px`;
            el.style.background = Math.random() > 0.5 ? '#FFC4E1' : '#FF73A7';
            el.style.borderRadius = '50%';
            confettiLayer.appendChild(el);
            
            el.animate(
                [{ transform: 'translateY(0) rotate(0)', opacity: 1 }, 
                 { transform: `translateY(150px) rotate(${Math.random() * 360}deg)`, opacity: 0 }], 
                { duration: Math.random() * 800 + 1400, easing: 'ease-out' }
            );
            setTimeout(() => el.remove(), 2200);
        }
    }
</script>

</body>
</html>



