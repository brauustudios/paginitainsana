
<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pagina para emo <3 </title>
      <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
      <link href="https://fonts.googleapis.com/css2?family=Delius&display=swap" rel="stylesheet">
      <link rel="icon" type="image/x-icon"
        href="https://cdn.pixabay.com/photo/2017/09/23/16/33/pixel-heart-2779422_1280.png">
      <style>
        :root {
          --bg1: #fff0f6;
          --bg2: #ffd7eb;
          --accent: #ff3b8d;
          --accent-light: #ff73a7;
          --accent-dark: #e5005e;
          --soft: rgba(255, 255, 255, 0.6);
          --glass: rgba(255, 255, 255, 0.18);
          --shadow: 0 10px 30px rgba(255, 60, 130, 0.15);
          --radius: 20px;
          --ui-pad: 14px;
        }

        * {
          box-sizing: border-box;
        }

        html,
        body {
          height: 100%;
          margin: 0;
          font-family: 'Delius', cursive;
          background: linear-gradient(135deg, #fff0f6 0%, #ffd7eb 100%);
          color: #2a2530;
          overflow-x: hidden;
          position: relative;
        }

        body::before {
          content: "";
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-image:
            radial-gradient(circle at 15% 50%, rgba(255, 182, 193, 0.2) 0%, transparent 25%),
            radial-gradient(circle at 85% 30%, rgba(255, 192, 203, 0.2) 0%, transparent 25%),
            radial-gradient(circle at 50% 80%, rgba(255, 182, 193, 0.2) 0%, transparent 25%);
          pointer-events: none;
          z-index: -1;
        }

        .wrap {
          min-height: 100dvh;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: flex-start;
          padding: 20px;
          gap: 20px;
        }

        .card {
          width: min(900px, 96%);
          background: linear-gradient(135deg, rgba(255, 255, 255, 0.85) 0%, rgba(255, 245, 250, 0.85) 100%);
          border-radius: var(--radius);
          padding: clamp(18px, 4vw, 28px);
          box-shadow: var(--shadow), 0 0 0 1px rgba(255, 255, 255, 0.5);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255, 20, 90, 0.1);
          position: relative;
          overflow: hidden;
        }

        .card::after {
          content: "";
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 6px;
          background: linear-gradient(90deg, #ff9ebb, #ff73a7, #ff3b8d);
          border-radius: 10px 10px 0 0;
        }

        .title-row {
          display: flex;
          align-items: center;
          gap: 12px;
          flex-wrap: wrap;
          justify-content: space-between;
          margin-bottom: 15px;
        }

        h1 {
          font-size: clamp(24px, 6vw, 38px);
          margin: 0;
          color: var(--accent);
          letter-spacing: .02em;
          display: flex;
          align-items: center;
          gap: .6rem;
          transform-origin: center;
          animation: titlePop 1s ease, textGlow 3s ease-in-out infinite alternate;
          text-shadow: 0 4px 12px rgba(255, 80, 150, 0.2);
          font-family: 'Press Start 2P', cursive;
          position: relative;
        }

        @keyframes titlePop {
          0% {
            transform: scale(.96);
            opacity: 0;
          }

          70% {
            transform: scale(1.05);
          }

          100% {
            transform: scale(1);
            opacity: 1;
          }
        }

        @keyframes textGlow {
          0% {
            text-shadow: 0 4px 12px rgba(255, 80, 150, 0.2);
          }

          100% {
            text-shadow: 0 4px 20px rgba(255, 80, 150, 0.5), 0 0 10px rgba(255, 100, 180, 0.3);
          }
        }

        .sub {
          color: #6e6170;
          font-weight: 700;
          font-size: 12px;
          font-family: 'Press Start 2P', cursive;
          animation: subtleFloat 6s ease-in-out infinite;
        }

        @keyframes subtleFloat {

          0%,
          100% {
            transform: translateY(0);
          }

          50% {
            transform: translateY(-3px);
          }
        }

        .player {
          display: grid;
          grid-template-columns: 1fr auto;
          gap: 16px;
          align-items: center;
          margin-top: 15px;
        }

        .play-card {
          background: rgba(255, 255, 255, 0.6);
          padding: 16px;
          border-radius: 16px;
          display: flex;
          gap: 16px;
          align-items: center;
          box-shadow: 0 6px 16px rgba(255, 50, 130, 0.08);
          border: 1px solid rgba(255, 255, 255, 0.6);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .play-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 25px rgba(255, 50, 130, 0.15);
        }

        .big-btn {
          background: linear-gradient(180deg, var(--accent-light), var(--accent));
          color: white;
          border: 0;
          padding: 12px 16px;
          border-radius: 14px;
          font-weight: bold;
          cursor: pointer;
          box-shadow: 0 5px 15px rgba(255, 60, 140, 0.25);
          display: inline-flex;
          align-items: center;
          gap: 8px;
          transition: all 0.2s ease;
          font-family: 'Delius', cursive;
          font-size: 15px;
          position: relative;
          overflow: hidden;
        }

        .big-btn::before {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
          transition: left 0.5s;
        }

        .big-btn:hover::before {
          left: 100%;
        }

        .big-btn:hover {
          transform: translateY(-3px);
          box-shadow: 0 8px 20px rgba(255, 60, 140, 0.35);
        }

        .big-btn:active {
          transform: translateY(1px);
          box-shadow: 0 3px 10px rgba(255, 60, 140, 0.2);
        }

        .seek {
          width: 100%;
          appearance: none;
          height: 8px;
          border-radius: 999px;
          background: linear-gradient(90deg, #ffd3ea, #ff9fd4);
          border: 1px solid rgba(255, 255, 255, 0.6);
          cursor: pointer;
          margin-top: 8px;
          transition: all 0.3s ease;
        }

        .seek:hover {
          height: 10px;
        }

        .seek::-webkit-slider-thumb {
          appearance: none;
          width: 20px;
          height: 20px;
          border-radius: 50%;
          background: white;
          border: 3px solid var(--accent);
          box-shadow: 0 3px 10px rgba(255, 60, 130, 0.3);
          cursor: pointer;
          transition: all 0.2s;
        }

        .seek::-webkit-slider-thumb:hover {
          transform: scale(1.15);
          box-shadow: 0 5px 15px rgba(255, 60, 130, 0.5);
        }

        .game-panel {
          margin-top: 20px;
          display: flex;
          gap: 16px;
          align-items: stretch;
          justify-content: space-between;
          flex-wrap: wrap;
        }

        .game-card {
          flex: 1;
          min-width: 200px;
          background: linear-gradient(135deg, rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.3));
          padding: 18px;
          border-radius: 16px;
          border: 1px solid rgba(255, 255, 255, 0.4);
          box-shadow: 0 6px 16px rgba(255, 50, 130, 0.08);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .game-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 25px rgba(255, 50, 130, 0.15);
        }

        .score {
          font-size: 24px;
          font-weight: 900;
          color: var(--accent);
          text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
          animation: pulse 2s infinite;
        }

        @keyframes pulse {
          0% {
            transform: scale(1);
          }

          50% {
            transform: scale(1.05);
          }

          100% {
            transform: scale(1);
          }
        }

        .small {
          font-size: 13px;
          color: #7b6e78;
          font-weight: 600;
          line-height: 1.5;
          animation: subtleFloat 8s ease-in-out infinite;
        }

        .game-viewport {
          width: 100%;
          height: 380px;
          border-radius: 16px;
          overflow: hidden;
          position: relative;
          background: linear-gradient(135deg, rgba(255, 230, 240, 0.9), rgba(255, 240, 246, 0.8));
          border: 2px dashed rgba(255, 100, 150, 0.2);
          margin-top: 15px;
          -webkit-tap-highlight-color: transparent;
          box-shadow: inset 0 0 20px rgba(255, 100, 150, 0.1);
          transition: all 0.3s ease;
        }

        .game-viewport:hover {
          box-shadow: inset 0 0 30px rgba(255, 100, 150, 0.2);
        }

        .hud-row {
          display: flex;
          gap: 10px;
          align-items: center;
        }

        .pixel-heart {
          width: 26px;
          height: 26px;
          display: inline-block;
          filter: drop-shadow(0 4px 8px rgba(255, 90, 160, 0.2));
          transform: translateY(0);
          animation: heartLift 3s ease-in-out infinite;
        }

        .pixel-heart:nth-child(2) {
          animation-delay: .4s;
        }

        .pixel-heart:nth-child(3) {
          animation-delay: .8s;
        }

        @keyframes heartLift {
          0% {
            transform: translateY(0) scale(.98);
          }

          50% {
            transform: translateY(-6px) scale(1.03);
          }

          100% {
            transform: translateY(0) scale(.98);
          }
        }

        footer {
          width: 100%;
          text-align: center;
          color: #856f80;
          font-weight: 700;
          font-size: 13px;
          margin-top: 20px;
          font-family: 'Press Start 2P', cursive;
          animation: subtleFloat 10s ease-in-out infinite;
        }

        .confetti {
          position: absolute;
          inset: 0;
          pointer-events: none;
          overflow: visible;
        }

        .vignette {
          position: fixed;
          inset: 0;
          pointer-events: none;
          background: radial-gradient(ellipse at center, rgba(0, 0, 0, 0) 40%, rgba(0, 0, 0, 0.03) 100%);
        }

        .floating-hearts {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          pointer-events: none;
          z-index: -1;
        }

        .floating-heart {
          position: absolute;
          width: 28px;
          height: 28px;
          opacity: 0.6;
          animation: float 18s infinite linear;
        }

        @keyframes float {
          0% {
            transform: translateY(100vh) rotate(0deg);
            opacity: 0.7;
          }

          100% {
            transform: translateY(-100px) rotate(360deg);
            opacity: 0;
          }
        }

        .audio-error {
          display: none;
          background: rgba(255, 200, 200, 0.8);
          border-radius: 8px;
          padding: 8px 12px;
          margin-top: 8px;
          font-size: 11px;
          color: #d32f2f;
        }

        .secret-message {
          position: fixed;
          bottom: 15px;
          left: 50%;
          transform: translateX(-50%);
          background: rgba(255, 255, 255, 0.95);
          padding: 12px 18px;
          border-radius: 24px;
          font-size: 13px;
          color: #ff3b8d;
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
          opacity: 0;
          transition: opacity 0.5s;
          z-index: 1000;
          text-align: center;
          max-width: 90%;
          font-weight: 600;
          border: 1px solid rgba(255, 100, 150, 0.2);
          animation: messageFloat 3s ease-in-out infinite;
        }

        @keyframes messageFloat {

          0%,
          100% {
            transform: translateX(-50%) translateY(0);
          }

          50% {
            transform: translateX(-50%) translateY(-5px);
          }
        }

        .note-bubble {
          position: fixed;
          bottom: 20px;
          right: 20px;
          width: 170px;
          min-height: 45px;
          max-height: 200px;
          background: rgba(255, 223, 235, 0.9);
          border: 2px dashed #ff3b8d;
          border-radius: 18px;
          padding: 10px;
          font-family: 'Press Start 2P', monospace;
          font-size: 11px;
          color: #2a2530;
          overflow-y: auto;
          box-shadow: 0 6px 18px rgba(255, 50, 130, 0.2);
          z-index: 9999;
          cursor: grab;
          line-height: 1.4;
          animation: bubbleFloat 8s ease-in-out infinite;
        }

        @keyframes bubbleFloat {

          0%,
          100% {
            transform: translateY(0) rotate(-1deg);
          }

          50% {
            transform: translateY(-10px) rotate(1deg);
          }
        }

        .sparkle {
          position: absolute;
          width: 10px;
          height: 10px;
          background: #fff;
          border-radius: 50%;
          pointer-events: none;
          z-index: 100;
          animation: sparkle 1s forwards;
        }

        @keyframes sparkle {
          0% {
            transform: translate(0, 0) scale(0);
            opacity: 1;
          }

          100% {
            transform: translate(var(--tx), var(--ty)) scale(1.5);
            opacity: 0;
          }
        }

        .reasons-section {
          margin-top: 30px;
          text-align: center;
        }

        .reasons-title {
          font-family: 'Press Start 2P', cursive;
          color: var(--accent);
          font-size: 18px;
          margin-bottom: 20px;
          text-shadow: 0 2px 4px rgba(255, 80, 150, 0.2);
          animation: textGlow 3s ease-in-out infinite alternate, subtleFloat 7s ease-in-out infinite;
        }

        .reasons-container {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 15px;
          margin-top: 15px;
        }

        .reason-card {
          background: rgba(255, 255, 255, 0.7);
          border-radius: 12px;
          padding: 15px;
          width: calc(50% - 15px);
          min-width: 250px;
          box-shadow: 0 4px 10px rgba(255, 60, 140, 0.1);
          transition: transform 0.3s ease, box-shadow 0.3s ease;
          animation: cardAppear 0.5s ease-out;
        }

        @keyframes cardAppear {
          0% {
            opacity: 0;
            transform: translateY(20px);
          }

          100% {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .reason-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 8px 20px rgba(255, 60, 140, 0.2);
        }

        .reason-number {
          background: var(--accent);
          color: white;
          width: 30px;
          height: 30px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto 10px;
          font-weight: bold;
          font-family: 'Press Start 2P', cursive;
          font-size: 10px;
          animation: pulse 2s infinite;
        }

        .reason-text {
          font-size: 14px;
          line-height: 1.4;
          animation: subtleFloat 9s ease-in-out infinite;
        }

        .apology-btn {
          margin-top: 20px;
          background: linear-gradient(180deg, #ff9ebb, #ff73a7);
        }

        .bubble-top-left {
          top: 50px;
          right: auto;
          left: 50px;
          bottom: auto;
          width: 160px;
          background: rgba(255, 236, 245, 0.9);
          border: 2px dashed #ff73a7;
          animation: bubbleFloat 7s ease-in-out infinite reverse;
        }

        #lastUpdate {
          position: fixed;
          top: 10px;
          left: 50%;
          transform: translateX(-50%);
          background: rgba(255, 182, 193, 0.85);
          color: white;
          font-family: 'Arial', sans-serif;
          font-size: 11px;
          padding: 6px 12px;
          border-radius: 20px;
          box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
          z-index: 2000;
          animation: fadeIn 2s ease-in-out;
        }

        @keyframes fadeIn {
          0% {
            opacity: 0;
          }

          100% {
            opacity: 1;
          }
        }

        .typewriter {
          overflow: hidden;
          border-right: 2px solid var(--accent);
          white-space: nowrap;
          margin: 0 auto;
          animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
          from {
            width: 0
          }

          to {
            width: 100%
          }
        }

        @keyframes blink-caret {

          from,
          to {
            border-color: transparent
          }

          50% {
            border-color: var(--accent);
          }
        }

        .falling-heart {
          transition: transform 0.3s ease, filter 0.3s ease;
        }

        .falling-heart:hover {
          transform: scale(1.2) !important;
          filter: brightness(1.2) drop-shadow(0 0 8px rgba(255, 100, 180, 0.5));
        }

        @media (max-width: 768px) {
          .player {
            grid-template-columns: 1fr;
          }

          .play-card {
            flex-direction: column;
            text-align: center;
            gap: 12px;
          }

          .game-panel {
            flex-direction: column;
          }

          .game-viewport {
            height: 300px;
          }

          h1 {
            font-size: 20px;
          }

          .reason-card {
            width: 100%;
          }

          .note-bubble {
            width: 140px;
            font-size: 9px;
            right: 10px;
            bottom: 10px;
          }

          .bubble-top-left {
            left: 10px;
            top: 10px;
            width: 130px;
          }
        }

        @media (max-width: 480px) {
          .game-viewport {
            height: 250px;
          }

          .note-bubble {
            width: 130px;
            font-size: 8px;
            right: 5px;
            bottom: 5px;
          }

          .big-btn {
            padding: 10px 12px;
            font-size: 14px;
          }

          .reason-card {
            min-width: 100%;
          }

          .bubble-top-left {
            left: 5px;
            top: 5px;
            width: 120px;
          }
        }

        .persistent-message {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 10000;
          opacity: 0;
          transition: opacity 0.3s ease;
        }

        .persistent-message.show {
          opacity: 1;
        }

        .message-content {
          background: rgba(255, 255, 255, 0.95);
          padding: 30px;
          border-radius: 20px;
          max-width: 500px;
          width: 90%;
          box-shadow: 0 15px 35px rgba(255, 60, 140, 0.3);
          border: 3px solid #ff73a7;
          position: relative;
          transform: scale(0.8);
          transition: transform 0.3s ease;
        }

        .persistent-message.show .message-content {
          transform: scale(1);
        }

        .close-btn {
          position: absolute;
          top: 15px;
          right: 15px;
          background: #ff3b8d;
          color: white;
          border: none;
          width: 30px;
          height: 30px;
          border-radius: 50%;
          cursor: pointer;
          font-size: 16px;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all 0.3s ease;
        }

        .close-btn:hover {
          background: #e5005e;
          transform: scale(1.1);
        }

        .message-text {
          font-family: 'Delius', cursive;
          color: #2a2530;
          font-size: 16px;
          line-height: 1.6;
          text-align: center;
          margin-top: 10px;
        }

        .album-cover {
          width: 80px;
          height: 80px;
          border-radius: 12px;
          object-fit: cover;
          margin-top: 8px;
          align-self: flex-start;
          box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
          animation: subtleFloat 10s ease-in-out infinite;
        }

        .chat-section {
          margin-top: 30px;
          text-align: center;
          width: 100%;
        }

        .chat-container {
          background: rgba(255, 255, 255, 0.7);
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 4px 10px rgba(255, 60, 140, 0.1);
          margin-top: 15px;
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
        }

        .chat-messages {
          height: 200px;
          overflow-y: auto;
          border: 2px dashed rgba(255, 100, 150, 0.2);
          border-radius: 10px;
          padding: 10px;
          margin-bottom: 15px;
          display: flex;
          flex-direction: column;
        }

        .chat-message {
          padding: 8px 12px;
          border-radius: 15px;
          margin-bottom: 8px;
          max-width: 70%;
          font-size: 14px;
          position: relative;
          animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-message.sent {
          background: var(--accent);
          color: white;
          align-self: flex-end;
          text-align: right;
        }
        
        .chat-message.received {
            background: #e9e9eb;
            color: #2a2530;
            align-self: flex-start;
            text-align: left;
        }
        
        .message-author {
            font-size: 10px;
            font-weight: bold;
            color: var(--accent-light);
            display: block;
            margin-bottom: 4px;
        }

        .chat-input-area {
          display: flex;
          gap: 10px;
          margin-top: 15px;
        }
        
        .recipient-selection {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-family: 'Press Start 2P', cursive;
            font-size: 12px;
        }

        #recipientSelect {
            border: 2px solid rgba(255, 100, 150, 0.2);
            border-radius: 10px;
            padding: 8px;
            font-family: 'Delius', cursive;
            font-size: 12px;
        }

        #chatInput {
          flex: 1;
          border: 2px solid rgba(255, 100, 150, 0.2);
          border-radius: 10px;
          padding: 10px;
          font-family: 'Delius', cursive;
          font-size: 14px;
        }

        #chatInput:focus, #recipientSelect:focus {
          outline: none;
          border-color: var(--accent);
        }

        #loginOverlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            backdrop-filter: blur(5px);
            transition: opacity 0.5s;
        }

        #loginBox {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            animation: floatPopup 1s ease;
        }
        
        #usernameInput {
            border: 2px solid rgba(255, 100, 150, 0.2);
            border-radius: 10px;
            padding: 10px;
            font-family: 'Delius', cursive;
            font-size: 16px;
            margin-top: 15px;
            margin-bottom: 15px;
        }

        #usernameError {
            color: red;
            font-size: 12px;
            margin-bottom: 10px;
            display: none;
        }

        #logoutBtn {
            background: #ff73a7;
            font-size: 12px;
            padding: 8px 12px;
            margin-top: 15px;
        }

      </style>
</head>

<body>

  <div id="loginOverlay">
      <div id="loginBox">
          <h2 class="reasons-title">Bienvenida <3</h2>
          <p>olap pon un nombre de usuario para entrar :3 </p>
          <input type="text" id="usernameInput" placeholder="Tu nombre...">
          <p id="usernameError">Ese nombre ya está en uso. Intenta con otro.</p>
          <button class="big-btn" id="loginBtn">Entrar</button>
      </div>
  </div>

  <div id="lastUpdate">Última actualización:12:56 PM 13/10/25</div>

  <div class="note-bubble" id="noteBubble">
    💌 ESPERO HOY TE VAYA DEMASIADO BIENBONITAHERMOSALINDA, RECUERDA QUE ESTAS MUY BONITA AUNQUE ESO YA LO SABES, ESPERO TE VAYUA MUY BIEN HOY Y DISCULPAME POR NO ACTUALIZAR LA PAGINA AHORITA ES QUE ME OCUPE MUCHO PERO YA ME DI EL TIEMPO PARA ACTUALIZAR LA PAGINITA, AHORITA QUE LLEGUE TE MANDO MENSAJE BONITA <33</div>

      <div class="note-bubble bubble-top-left" id="noteBubble2">
        ME GUSTAS MUCHO QUE TE PASA, QUISIERA ESTAR AHORA MISMO CONTIGO, MIRA AHI TE VA UN CHISTE: ¿que le dice un perro a otro?...
        guau guau, JAKAKJ
        <img src="https://img.favpng.com/15/1/11/laughing-emoji-laughing-yellow-emoji-with-hands-raised-AeDcYzcG.jpg" alt="emoji"
          style="width:35px; height:25px; vertical-align:middle;">
      </div>

      <div class="floating-hearts" id="floatingHearts"></div>

      <div class="vignette"></div>

      <div class="wrap" style="display: none;">
        <div class="card" role="region" aria-label="Dedicado">
          <div class="title-row">
            <div style="display:flex;align-items:center;gap:12px">
              <h1>
                <img src="https://art.pixilart.com/2d2ed65cc301.png" width="32" height="32" style="margin-right:8px">
                <span class="typewriter">PARA TI</span>
              </h1>

              <div class="hud-row small">
                <img class="pixel-heart" src="https://art.pixilart.com/2d2ed65cc301.png" width="26" height="26"
                  alt="Corazón">
                <img class="pixel-heart" src="https://art.pixilart.com/2d2ed65cc301.png" width="26" height="26"
                  alt="Corazón">
                <img class="pixel-heart" src="https://art.pixilart.com/2d2ed65cc301.png" width="26" height="26"
                  alt="Corazón">
              </div>
            </div>

            <div class="texto-centrado" style="text-align: center; margin: 30px 0 20px 0;">
              <h2
                style="font-family: 'Press Start 2P', cursive; color: #ff3b8d; font-size: 24px; text-shadow: 0 4px 12px rgba(255, 80, 150, 0.3); line-height: 1.4; animation: textGlow 3s ease-in-out infinite alternate;">
                <3333 </h2>
                  <p
                    style="font-family: 'Delius', cursive; color: #6e6170; font-size: 16px; margin-top: 15px; line-height: 1.5; padding: 0 10px; animation: subtleFloat 10s ease-in-out infinite;">
                    💌 ERES LAMAS HERMOSA <3333 </p>
            </div>

            <div style="text-align: center; margin: 20px 0;">
              <img src="https://i.ibb.co/21npLkTH/7cbaa984e87790964fe0dd4da52fd4b3.jpg" alt="rendersito"
                style="max-width: 100%; height: auto; border-radius: 15px; box-shadow: 0 5px 15px rgba(255, 255, 255, 0.25); transition: transform 0.5s ease, box-shadow 0.5s ease;">
            </div>

            <div style="display:flex;gap:10px;align-items:center">
              <div class="sub">emocat · my · special · girl</div>
              <button class="big-btn" id="shareBtn" aria-label="Compartir">💌 Compartir</button>
            </div>
          </div>
          
          <div class="player" style="margin-top:15px">
            <div class="play-card">
              <div style="display:flex;flex-direction:column;gap:8px;flex:1">
                  <div style="display:flex;align-items:center;justify-content:space-between;gap:10px;">
                      <div style="display:flex;flex-direction:column">
                          <strong id="songTitle" style="color:var(--accent);font-size:16px; animation: subtleFloat 8s ease-in-out infinite;">ICNBYH</strong>
                          <span id="songArtist" class="small">Cuco</span>
                          <img id="albumCoverImg" src="https://is1-ssl.mzstatic.com/image/thumb/Music211/v4/ff/6b/23/ff6b23a2-613a-98f2-6098-008412568e71/25UMGIM05523.rgb.jpg/1200x1200bf-60.jpg" alt="Portada del álbum" class="album-cover">
                      </div>
                      <div style="display:flex;gap:10px;align-items:center">
                          <button class="big-btn" id="prevBtn" style="font-size: 20px; padding: 8px 14px;">⏪</button>
                          <button class="big-btn" id="playToggle">▶</button>
                          <button class="big-btn" id="nextBtn" style="font-size: 20px; padding: 8px 14px;">⏩</button>
                      </div>
                  </div>
                  <audio id="audio" preload="metadata">
                      <source src="" type="audio/mpeg">
                      Tu navegador no soporta audio.
                  </audio>
                  <div class="audio-error" id="audioError">
                      No se pudo cargar el audio. Asegúrate de tener conexión a internet.
                  </div>
                  <input type="range" id="seek" class="seek" min="0" step="0.1" value="0" aria-label="barra de progreso">
              </div>
              <div style="width:160px;display:flex;flex-direction:column;align-items:flex-end">
                  <div style="font-weight:900;color:#7b6374;font-size:15px; animation: subtleFloat 9s ease-in-out infinite;">
                      Reproduce esta canción (todas estas cancioncitas te las dedico)
                  </div>
                  <div class="small" style="margin-top:8px">Toca la pantalla para crear corazones</div>
              </div>
            </div>

            <div style="width:220px;display:flex;flex-direction:column;gap:10px">
              <div class="game-card">
                <div style="display:flex;justify-content:space-between;align-items:center">
                  <div class="small">Juego</div>
                  <div class="score" id="score">0</div>
                </div>
                <div style="margin-top:10px;font-size:13px;color:#6b5866">Atrapa corazones tocándolos. Duración 25s
                </div>
                <div style="display:flex;gap:10px;margin-top:15px">
                  <button class="big-btn" id="startGame" style="padding:10px 12px;font-size:13px">Jugar</button>
                  <button class="big-btn" id="resetGame"
                    style="padding:10px 12px;font-size:13px;background:linear-gradient(180deg,#fff,#ffd7ec);color:var(--accent)">Reset</button>
                </div>
              </div>
            </div>
          </div>
          <div class="game-panel">
            <div class="game-card" style="flex:1">
              <div id="viewport" class="game-viewport" aria-label="Área de juego táctil">
              </div>
            </div>
            <div class="game-card" style="width:220px">
              <div
                style="font-weight:900;color:var(--accent);font-size:20px; animation: textGlow 3s ease-in-out infinite alternate;">
                Logros</div>
              <div style="margin-top:10px" id="achievements">
                <div class="small">— Toca para crear corazoncitos</div>
                <div class="small">— Aumenta la dificultad a 15 pts</div>
                <div class="small">— <33 </div>
                </div>
              </div>
            </div>

            <div class="reasons-section">
              <div class="reasons-title">8 razones por las que me enamore de ti</div>
              <div class="reasons-container">
                <div class="reason-card">
                  <div class="reason-number">1</div>
                  <div class="reason-text">Primeramente, porque eres unica.</div>
                </div>
                <div class="reason-card">
                  <div class="reason-number">2</div>
                  <div class="reason-text">Me gusta hablar contigo.</div>
                </div>
                <div class="reason-card">
                  <div class="reason-number">3</div>
                  <div class="reason-text">Me encanta hablar solo contigo incluso cuando no tengo ganas de hacerlo.
                  </div>
                </div>
                <div class="reason-card">
                  <div class="reason-number">4</div>
                  <div class="reason-text">Eres demasiado bonita (la mas bonita que eh conocido).</div>
                </div>
                <div class="reason-card">
                  <div class="reason-number">5</div>
                  <div class="reason-text">Tu voz, en serio es encantadora.</div>
                </div>
                <div class="reason-card">
                  <div class="reason-number">6</div>
                  <div class="reason-text">nunca habia sentido algo asi por alguien y eso te lo juro por mi vida.</div>
                </div>
                <div class="reason-card">
                  <div class="reason-number">7</div>
                  <div class="reason-text">Enserio Te quiero demasiado.</div>
                </div>
                <div class="reason-card">
                  <div class="reason-number">8</div>
                  <div class="reason-text">Simplemente eres tú, y eso es más que suficiente para mí.</div>
                </div>
              </div>
              
              <div>
                <button class="big-btn apology-btn" id="apologyBtn">picale aqui JAJSJD</button>
              </div>
            </div>

            <div class="chat-section">
              <h2 class="reasons-title">CHATSITO <33 </h2>
              <p id="currentUserDisplay" style="font-family: 'Press Start 2P', cursive; font-size: 12px; color: var(--accent-dark);"></p>
              <div class="chat-container">
                <div class="recipient-selection">
                    <span>Enviar a:</span>
                    <select id="recipientSelect">
                        <option value="">Selecciona a alguien</option>
                    </select>
                </div>
                <div class="chat-messages" id="chatMessages">
                </div>
                <div class="chat-input-area">
                  <input type="text" id="chatInput" placeholder="Escribe algo...">
                  <button class="big-btn" id="sendMessageBtn">Enviar</button>
                </div>
              </div>
              <button class="big-btn" id="logoutBtn">Cerrar Sesión</button>
            </div>
            
            <div style="display:flex;gap:10px;align-items:center;margin-top:15px;flex-wrap:wrap;">
                <button class="big-btn" id="moreHearts">💗 +Hacer llover corazones</button>
                <button class="big-btn" id="miniConfetti"
                  style="background:linear-gradient(180deg,#fff,#ffe6f2);color:var(--accent)"> Celebrar</button>
            </div>
            <div class="confetti" id="confetti"></div>
            
            <footer>
              Hecho con por braw para emo (tequieromucho mariana.)
              <p style="font-size: 6px; color: gray; margin-top: 30px;">
                Powered By BrauuStudiosSC
              </p>
            </footer>
          </div>

          <div class="secret-message" id="secretMessage"></div>

          <div class="vignette" aria-hidden="true"></div>

          <script type="module">
              import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
              import { getDatabase, ref, push, onValue, get, set, off } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-database.js";

              const firebaseConfig = {
                apiKey: "AIzaSyDj2tNpNgiZPWtTYKotGq3ULALzJltHOKM",
                authDomain: "pagina-81a41.firebaseapp.com",
                databaseURL: "https://pagina-81a41-default-rtdb.firebaseio.com",
                projectId: "pagina-81a41",
                storageBucket: "pagina-81a41.firebasestorage.app",
                messagingSenderId: "803503362455",
                appId: "1:803503362455:web:ebf1271cf65943210174d2"
              };

              const app = initializeApp(firebaseConfig);
              const db = getDatabase(app);
              
              let currentUser = localStorage.getItem('username');
              let currentChatRoomId = null;
              let messagesRef = null;

              const loginOverlay = document.getElementById('loginOverlay');
              const usernameInput = document.getElementById('usernameInput');
              const loginBtn = document.getElementById('loginBtn');
              const usernameError = document.getElementById('usernameError');
              const wrap = document.querySelector('.wrap');
              const logoutBtn = document.getElementById('logoutBtn');

              let sessionStartTime = null;

              async function login() {
                  const username = usernameInput.value.trim().toLowerCase();
                  if (username === '') return;

                  const usersRef = ref(db, 'users/' + username);
                  const snapshot = await get(usersRef);

                  if (snapshot.exists()) {
                      usernameError.style.display = 'block';
                  } else {
                      await set(usersRef, true);
                      localStorage.setItem('username', username);
                      currentUser = username;
                      loginOverlay.style.display = 'none';
                      wrap.style.display = 'flex';
                      initializeAppLogic();
                  }
              }

              function logout() {
                const sessionDurationSeconds = Math.round((Date.now() - sessionStartTime) / 1000);
                logUserActivity('SESSION_END', { durationSeconds: sessionDurationSeconds });
                logUserActivity('LOGOUT');
                localStorage.removeItem('username');
                window.location.reload();
              }

              loginBtn.addEventListener('click', login);
              logoutBtn.addEventListener('click', logout);
              usernameInput.addEventListener('keydown', (e) => {
                  if (e.key === 'Enter') login();
              });

              if (currentUser) {
                  loginOverlay.style.display = 'none';
                  wrap.style.display = 'flex';
                  initializeAppLogic();
              }
              
              async function logUserActivity(eventType, details = {}) {
                  if (!currentUser) return;
                  try {
                      await push(ref(db, "user_logs"), {
                          user: currentUser,
                          eventType: eventType,
                          details: details,
                          timestamp: new Date().toISOString(),
                          url: window.location.href
                      });
                  } catch (e) {
                      console.error(`Error al registrar el evento '${eventType}':`, e);
                  }
              }
              
              function initializeAppLogic() {
                document.getElementById('currentUserDisplay').textContent = `${currentUser}`;
                const recipientSelect = document.getElementById('recipientSelect');
                const usersRef = ref(db, 'users');
                const chatInput = document.getElementById('chatInput');
                const sendMessageBtn = document.getElementById('sendMessageBtn');

                // --- INICIO DE SESIÓN Y REGISTRO DE EVENTOS ---
                
                // 1. Inicia el contador de sesión y registra la visita
                sessionStartTime = Date.now();
                logUserActivity('LOGIN_SUCCESS');
                
                // 2. Registra la visita en el sistema ANTIGUO
                async function registrarVisitaAntigua() {
                    try {
                        await push(ref(db, "visitas_brauu"), {
                            user: currentUser,
                            mensaje: `${currentUser} abrió la página 💗`,
                            timestamp: new Date().toISOString()
                        });
                    } catch (e) { console.error("Error registrando visita (sistema antiguo):", e); }
                }
                registrarVisitaAntigua();

                // 3. Registra cuando el usuario cierra o recarga la página
                window.addEventListener('beforeunload', () => {
                    const sessionDurationSeconds = Math.round((Date.now() - sessionStartTime) / 1000);
                    logUserActivity('SESSION_END', { durationSeconds: sessionDurationSeconds });
                });

                // --- LÓGICA DEL CHAT Y SUS EVENTOS ---
                onValue(usersRef, (snapshot) => {
                    const currentRecipient = recipientSelect.value;
                    recipientSelect.innerHTML = '<option value="">Selecciona a alguien</option>';
                    const users = snapshot.val();
                    if(users) {
                        Object.keys(users).forEach(user => {
                            if(user !== currentUser) {
                                const option = document.createElement('option');
                                option.value = user;
                                option.textContent = user;
                                recipientSelect.appendChild(option);
                            }
                        });
                    }
                    if (currentRecipient) {
                        recipientSelect.value = currentRecipient;
                    }
                });
                
                recipientSelect.addEventListener('change', () => {
                    const selectedUser = recipientSelect.value;
                    if (selectedUser) {
                        logUserActivity('CHAT_SELECT_RECIPIENT', { recipient: selectedUser });
                    }
                    loadChat(selectedUser);
                });

                chatInput.addEventListener('focus', () => {
                    logUserActivity('CHAT_INPUT_FOCUS');
                });
                
                async function sendMessage() {
                    const recipient = recipientSelect.value;
                    const messageText = chatInput.value.trim();
                    if (recipient && messageText) {
                        const chatRoomId = [currentUser, recipient].sort().join('_');
                        try {
                            await push(ref(db, `chats/${chatRoomId}`), {
                                text: messageText,
                                author: currentUser,
                                timestamp: new Date().toISOString()
                            });
                            logUserActivity('CHAT_MESSAGE_SENT', { recipient: recipient, messageLength: messageText.length });
                            chatInput.value = '';
                        } catch(e) {
                            console.error("Error al enviar mensaje:", e);
                        }
                    }
                }

                sendMessageBtn.addEventListener('click', sendMessage);
                chatInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') sendMessage();
                });

                // --- REGISTRO DE CLICS EN BOTONES ---
                const apologyButton = document.getElementById("apologyBtn");
                if (apologyButton) {
                    apologyButton.addEventListener("click", async () => {
                        // Nuevo sistema de logs
                        logUserActivity('BUTTON_CLICK', { buttonId: 'apologyBtn' });
                        // Antiguo sistema de logs
                        try {
                            await push(ref(db, "clicks_brauu"), {
                                user: currentUser,
                                mensaje: `${currentUser} le picó al botón JAJSJD`,
                                timestamp: new Date().toISOString()
                            });
                        } catch (e) { console.error("Error al guardar clic (sistema antiguo):", e); }
                    });
                }
                
                document.getElementById("moreHearts").addEventListener("click", () => logUserActivity('BUTTON_CLICK', { buttonId: 'moreHearts' }));
                document.getElementById("miniConfetti").addEventListener("click", () => logUserActivity('BUTTON_CLICK', { buttonId: 'miniConfetti' }));
                document.getElementById("shareBtn").addEventListener("click", () => logUserActivity('BUTTON_CLICK', { buttonId: 'shareBtn' }));

                // --- REGISTRO DE EVENTOS DEL JUEGO ---
                document.getElementById("startGame").addEventListener("click", () => logUserActivity('GAME_START'));
                document.getElementById("resetGame").addEventListener("click", () => logUserActivity('GAME_RESET'));
                // El evento GAME_END se registra desde la función endGame() en el otro script.

                // --- REGISTRO DE EVENTOS DEL AUDIO ---
                const audioPlayer = document.getElementById('audio');
                audioPlayer.addEventListener('play', () => logUserActivity('AUDIO_PLAY'));
                audioPlayer.addEventListener('pause', () => logUserActivity('AUDIO_PAUSE'));
              }

              function loadChat(recipient) {
                const chatMessages = document.getElementById('chatMessages');
                if (messagesRef) {
                    off(messagesRef);
                }
                chatMessages.innerHTML = '';

                if (recipient) {
                    currentChatRoomId = [currentUser, recipient].sort().join('_');
                    messagesRef = ref(db, `chats/${currentChatRoomId}`);

                    onValue(messagesRef, (snapshot) => {
                        chatMessages.innerHTML = '';
                        const data = snapshot.val();
                        if (data) {
                            Object.values(data).sort((a,b) => new Date(a.timestamp) - new Date(b.timestamp)).forEach(message => {
                                const messageElement = document.createElement('div');
                                messageElement.classList.add('chat-message');
                                
                                const authorElement = document.createElement('span');
                                authorElement.classList.add('message-author');
                                authorElement.textContent = message.author;
                                
                                messageElement.textContent = message.text;

                                if (message.author === currentUser) {
                                    messageElement.classList.add('sent');
                                } else {
                                    messageElement.classList.add('received');
                                    messageElement.prepend(authorElement);
                                }
                                chatMessages.appendChild(messageElement);
                            });
                            chatMessages.scrollTop = chatMessages.scrollHeight;
                        }
                    });
                }
              }
          </script>

          <script>
            function initFloatingHearts() {
              const container = document.getElementById('floatingHearts');
              for (let i = 0; i < 25; i++) {
                const heart = document.createElement('img');
                heart.src = 'https://art.pixilart.com/2d2ed65cc301.png';
                heart.className = 'floating-heart';
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDelay = Math.random() * 20 + 's';
                heart.style.animationDuration = (15 + Math.random() * 15) + 's';
                heart.style.width = '28px';
                heart.style.height = '28px';
                container.appendChild(heart);
              }
            }

            function createSparkle(x, y) {
              const sparkle = document.createElement('div');
              sparkle.className = 'sparkle';
              sparkle.style.left = x + 'px';
              sparkle.style.top = y + 'px';

              const tx = (Math.random() - 0.5) * 100;
              const ty = (Math.random() - 0.5) * 100;
              sparkle.style.setProperty('--tx', tx + 'px');
              sparkle.style.setProperty('--ty', ty + 'px');

              document.body.appendChild(sparkle);

              setTimeout(() => {
                sparkle.remove();
              }, 1000);
            }

            // --- INICIO DE LA LÓGICA DE LA PLAYLIST ---

            // 1. Define tu playlist aquí. Agrega tantas canciones como quieras.
            // Asegúrate de que los nombres de los archivos (src) sean correctos.
            const playlist = [
              {
                title: 'ICNBYH',
                artist: 'Cuco',
                src: 'cancion5.mp3', // La canción que ya tenías
                cover: 'https://is1-ssl.mzstatic.com/image/thumb/Music211/v4/ff/6b/23/ff6b23a2-613a-98f2-6098-008412568e71/25UMGIM05523.rgb.jpg/1200x1200bf-60.jpg'
              },
              {
                title: 'Para Ti',
                artist: 'Cuco',
                src: 'cancion6.mp3', // Reemplaza con el nombre de tu archivo
                cover: 'https://is1-ssl.mzstatic.com/image/thumb/Music211/v4/ff/6b/23/ff6b23a2-613a-98f2-6098-008412568e71/25UMGIM05523.rgb.jpg/1200x1200bf-60.jpg' // Reemplaza con la URL de la portada
              },
              {
                title: 'Amor de siempre',
                artist: 'Cuco',
                src: 'cancion7.mp3', // Reemplaza con el nombre de tu archivo
                cover: 'https://i.scdn.co/image/ab67616d0000b273b1c091e32aad5310ebbdd558' // Reemplaza con la URL de la portada
              }
              // Puedes agregar más canciones aquí...
              // { title: '...', artist: '...', src: '...', cover: '...' }
            ];

            // 2. Variables para controlar el estado
            let currentSongIndex = 0;
            let isPlaying = false;

            // 3. Referencias a los elementos del DOM (HTML)
            const audio = document.getElementById('audio');
            const audioSource = audio.querySelector('source');
            const playToggle = document.getElementById('playToggle');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const seek = document.getElementById('seek');
            const audioError = document.getElementById('audioError');
            const songTitleEl = document.getElementById('songTitle');
            const songArtistEl = document.getElementById('songArtist');
            const albumCoverImgEl = document.getElementById('albumCoverImg');

            // 4. Función para cargar una canción
            function loadSong(songIndex) {
              const song = playlist[songIndex];
              songTitleEl.textContent = song.title;
              songArtistEl.textContent = song.artist;
              albumCoverImgEl.src = song.cover;
              audioSource.src = song.src;
              audio.load(); // Carga el nuevo archivo de audio
              seek.value = 0; // Reinicia la barra de progreso
            }

            // 5. Funciones para reproducir y pausar
            function playSong() {
              audio.play().then(() => {
                isPlaying = true;
                playToggle.textContent = '⏸';
              }).catch(e => {
                  console.warn('No se pudo reproducir:', e);
                  audioError.style.display = 'block';
                  audioError.textContent = 'No se pudo reproducir el audio. Haz clic para intentar de nuevo.';
              });
            }

            function pauseSong() {
              audio.pause();
              isPlaying = false;
              playToggle.textContent = '▶';
            }

            // 6. Lógica para los botones
            playToggle.addEventListener('click', () => {
              if (isPlaying) {
                pauseSong();
              } else {
                playSong();
              }
            });

            nextBtn.addEventListener('click', () => {
              currentSongIndex = (currentSongIndex + 1) % playlist.length; // Va a la siguiente y vuelve al inicio si es la última
              loadSong(currentSongIndex);
              if(isPlaying) playSong(); // Si estaba sonando, reproduce la nueva canción
            });

            prevBtn.addEventListener('click', () => {
              currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length; // Va a la anterior y a la última si es la primera
              loadSong(currentSongIndex);
              if(isPlaying) playSong(); // Si estaba sonando, reproduce la nueva canción
            });

            // 7. Actualizar la barra de progreso
            audio.addEventListener('timeupdate', () => {
              if (audio.duration) {
                seek.value = audio.currentTime;
                seek.max = audio.duration;
              }
            });

            seek.addEventListener('input', () => {
              audio.currentTime = seek.value;
            });

            // 8. Pasar a la siguiente canción automáticamente cuando termina una
            audio.addEventListener('ended', () => {
              nextBtn.click(); // Simula un clic en el botón de siguiente
            });

            audio.addEventListener('error', function () {
              audioError.style.display = 'block';
              console.error('Error al cargar el archivo de audio.');
            });

            // 9. Cargar la primera canción al iniciar la página
            loadSong(currentSongIndex);

            // --- FIN DE LA LÓGICA DE LA PLAYLIST ---

            const viewport = document.getElementById('viewport');
            const confettiLayer = document.getElementById('confetti');

            function createFallingHeart(xPercent, size = 50, speed = 7000) {
              const heart = document.createElement('img');
              heart.src = 'https://art.pixilart.com/2d2ed65cc301.png';
              heart.style.position = 'absolute';
              heart.style.left = xPercent + '%';
              heart.style.width = size + 'px';
              heart.style.height = size + 'px';
              heart.style.transform = 'translate(-50%, -10px)';
              heart.style.cursor = 'pointer';
              heart.style.zIndex = '5';
              heart.className = 'falling-heart';
              heart.style.transition = 'transform 0.2s, filter 0.2s';
              heart.style.pointerEvents = 'auto';

              const drift = (Math.random() * 30) - 15;
              const startY = -40;
              const endY = viewport.clientHeight + 60;
              const animation = heart.animate([
                { transform: `translate(-50%, ${startY}px)`, opacity: 1 },
                { transform: `translate(calc(-50% + ${drift}px), ${endY}px)`, opacity: 0.05 }
              ], { duration: speed + (Math.random() * 1000), easing: 'cubic-bezier(.2,.7,.2,1)' });

              animation.onfinish = () => { heart.remove(); };

              heart.addEventListener('mouseover', () => {
                heart.style.transform = 'translate(-50%, -10px) scale(1.15)';
                heart.style.filter = 'brightness(1.2) drop-shadow(0 0 8px rgba(255, 100, 180, 0.5))';
              });

              heart.addEventListener('mouseout', () => {
                heart.style.transform = 'translate(-50%, -10px) scale(1)';
                heart.style.filter = 'none';
              });

              return heart;
            }

            const scoreEl = document.getElementById('score');
            let score = 0;
            let gameInterval = null;
            let spawnInterval = 1300;
            let gameRunning = false;
            let gameTimeout = null;
            
            // --- CÓDIGO ACTUALIZADO PARA REGISTRAR EVENTOS DEL JUEGO ---
            // Usaremos una función global para poder llamarla desde el otro script
            window.logUserActivityForGame = async function(eventType, details = {}) {
                const currentUser = localStorage.getItem('username');
                if (!currentUser) return;
                try {
                    // Re-importamos 'push' y 'ref' porque este script no es un módulo
                    const { getDatabase, ref, push } = await import("https://www.gstatic.com/firebasejs/10.14.0/firebase-database.js");
                    const db = getDatabase();
                    await push(ref(db, "user_logs"), {
                        user: currentUser,
                        eventType: eventType,
                        details: details,
                        timestamp: new Date().toISOString()
                    });
                } catch(e) { console.error("Error registrando evento de juego:", e); }
            }

            function startGame() {
              if (gameRunning) return;
              score = 0; scoreEl.textContent = score;
              gameRunning = true;
              gameInterval = setInterval(() => {
                spawnHeartRandom();
              }, spawnInterval);
              viewport.addEventListener('click', onViewportClick);
              gameTimeout = setTimeout(endGame, 25000);
              showSecretMessage("❤️ Toca los corazones que caen");
            }

            function endGame() {
              gameRunning = false;
              clearInterval(gameInterval);
              viewport.removeEventListener('click', onViewportClick);
              if (score >= 10) celebrate();
              let message = "Juego terminado! Puntaje: " + score + " ";
              if (score < 5) message += "💔 Sigue intentando";
              else if (score < 10) message += "❤️ Bien";
              else if (score < 15) message += "💖 Excelente";
              else message += "💕";
              showSecretMessage(message);
              // --- REGISTRO DEL FIN DEL JUEGO ---
              window.logUserActivityForGame('GAME_END', { finalScore: score });
            }

            function resetGame() {
              score = 0; scoreEl.textContent = score;
              gameRunning = false;
              clearInterval(gameInterval);
              if (gameTimeout) clearTimeout(gameTimeout);
              document.querySelectorAll('.falling-heart').forEach(e => e.remove());
            }

            function spawnHeartRandom() {
              const x = Math.random() * 100;
              const heart = createFallingHeart(x, 50, 5000 + Math.random() * 2000);
              heart.addEventListener('click', (ev) => {
                ev.stopPropagation();
                collectHeart(heart);
              }, { passive: false });
              viewport.appendChild(heart);
              if (score >= 15 && gameInterval) {
                clearInterval(gameInterval);
                spawnInterval = Math.max(800, spawnInterval - 100);
                gameInterval = setInterval(spawnHeartRandom, spawnInterval);
              }
            }

            function collectHeart(node) {
              node.remove();
              score += 1;
              scoreEl.textContent = score;
              createSparkle(
                node.getBoundingClientRect().left + node.width / 2,
                node.getBoundingClientRect().top + node.height / 2
              );
              burstAt(node.getBoundingClientRect().left + node.clientWidth / 2, node.getBoundingClientRect().top + node.clientHeight / 2);
            }

            function onViewportClick(e) {
              const rect = viewport.getBoundingClientRect();
              const x = ((e.clientX - rect.left) / rect.width) * 100;
              const heart = createFallingHeart(x, 40, 3000 + Math.random() * 1000);
              viewport.appendChild(heart);
              heart.addEventListener('click', ev => { ev.stopPropagation(); collectHeart(heart); }, { passive: false });
              createSparkle(e.clientX, e.clientY);
            }

            function burstAt(pageX, pageY) {
              const c = document.createElement('div');
              c.style.position = 'absolute';
              const baseRect = confettiLayer.getBoundingClientRect();
              c.style.left = (pageX - baseRect.left) + 'px';
              c.style.top = (pageY - baseRect.top) + 'px';
              c.style.pointerEvents = 'none';
              for (let i = 0; i < 8; i++) {
                const p = document.createElement('div');
                p.style.width = p.style.height = (6 + Math.random() * 6) + 'px';
                p.style.background = i % 2 == 0 ? '#ff6aa6' : '#ff2e81';
                p.style.position = 'absolute';
                p.style.left = '0px'; p.style.top = '0px';
                p.style.borderRadius = '50%';
                c.appendChild(p);
                const dx = (Math.random() * 100 - 50);
                const dy = (Math.random() * 100 - 60);
                p.animate([{ transform: 'translate(0,0)', opacity: 1 }, { transform: `translate(${dx}px, ${dy}px) scale(.4)`, opacity: 0 }], { duration: 700 + Math.random() * 300, easing: 'cubic-bezier(.2,.8,.2,1)' });
              }
              confettiLayer.appendChild(c);
              setTimeout(() => c.remove(), 1100);
            }

            document.getElementById('startGame').addEventListener('click', startGame);
            document.getElementById('resetGame').addEventListener('click', resetGame);
            
            document.getElementById('apologyBtn').addEventListener('click', () => {
              const messageText = "OSTIA LE PICASTE, QUIERO ESTAR CONTIGO, QUIERO AMARTE QUIERO DARTE MUCHOS REGALITOS, QUIERO DARTE TODO MI CARIÑO ES QUE TE QUIERO DEMASIADO, TE AMO, QUEHERMOSAESTAS ESTAS BIEN BONITA DIOSMIO. quiero que recuerdes que siempre voy a estar aqui para ti si? enserio quiero darte todo mi cariño, tu sabes lo mucho que me estoy esforzando por mi persona aunque ahorita no pueda hacer muchas cosas por todo lo que tengo que hacer en un poco tiempo sera posible, estoy bastante feliz conmigo mismo y quiero darte todo mi amor, todo todo, quiero hacer demasiadas cosas por ti, la vida me esta dando muchas oportunidades que quisiera compartir lo que sigue contigo <333";
              const persistentMessage = document.createElement('div');a
              persistentMessage.className = 'persistent-message';
              persistentMessage.innerHTML = `
                <div class="message-content">
                  <button class="close-btn">✕</button>
                  <div class="message-text">${messageText}</div>
                </div>
              `;
              document.body.appendChild(persistentMessage);
              setTimeout(() => {
                persistentMessage.classList.add('show');
              }, 10);
              persistentMessage.querySelector('.close-btn').addEventListener('click', () => {
                persistentMessage.classList.remove('show');
                setTimeout(() => {
                  persistentMessage.remove();
                }, 300);
              });
              persistentMessage.addEventListener('click', (e) => {
                if (e.target === persistentMessage) {
                  persistentMessage.classList.remove('show');
                  setTimeout(() => {
                    persistentMessage.remove();
                  }, 300);
                }
              });
              for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                  const x = 10 + Math.random() * 80;
                  const heart = createFallingHeart(x, 45, 3500 + Math.random() * 1500);
                  heart.addEventListener('click', ev => { ev.stopPropagation(); collectHeart(heart); }, { passive: false });
                  viewport.appendChild(heart);
                }, i * 150);
              }
              celebrate();
            });

            document.getElementById('moreHearts').addEventListener('click', () => {
              for (let i = 0; i < 8; i++) {
                setTimeout(() => {
                  const x = 10 + Math.random() * 80;
                  const heart = createFallingHeart(x, 45, 3500 + Math.random() * 1500);
                  heart.addEventListener('click', ev => { ev.stopPropagation(); collectHeart(heart); }, { passive: false });
                  viewport.appendChild(heart);
                }, i * 150);
              }
              showSecretMessage("¡Lluvia de corazones! 💖");
            });

            function celebrate() {
              for (let i = 0; i < 40; i++) {
                const el = document.createElement('div');
                el.style.position = 'absolute';
                el.style.left = (Math.random() * 100) + '%';
                el.style.top = (Math.random() * 30) + '%';
                el.style.width = el.style.height = (6 + Math.random() * 8) + 'px';
                el.style.background = Math.random() > 0.5 ? '#ffd3ea' : '#ff8ab8';
                el.style.opacity = '0.95';
                el.style.borderRadius = '50%';
                confettiLayer.appendChild(el);
                el.animate([{ transform: 'translateY(0) rotate(0)', opacity: 1 }, { transform: `translateY(260px) rotate(${Math.random() * 360}deg)`, opacity: 0 }], { duration: 1400 + Math.random() * 800, easing: 'cubic-bezier(.2,.7,.2,1)' });
                setTimeout(() => el.remove(), 2200);
              }
            }

            document.getElementById('miniConfetti').addEventListener('click', function () {
              celebrate();
              showSecretMessage("🎉");
            });

            document.getElementById('shareBtn').addEventListener('click', async () => {
              const shareData = { title: 'PAGINITA', text: 'Mira esto', url: location.href };
              try {
                if (navigator.share) { await navigator.share(shareData); }
                else {
                  showSecretMessage("Copia el enlace para compartir 📋");
                }
              } catch (e) { console.warn(e); }
            });

            function showSecretMessage(text) {
              const messageEl = document.getElementById('secretMessage');
              messageEl.textContent = text;
              messageEl.style.opacity = '1';
              setTimeout(() => {
                messageEl.style.opacity = '0';
              }, 3000);
            }

            document.addEventListener('click', (e) => {
              createSparkle(e.clientX, e.clientY);
            });

            document.querySelector('.card').addEventListener('click', (e) => {
              if (e.target.closest('.big-btn') || e.target.closest('input') || e.target.closest('button')) return;
              const rect = e.currentTarget.getBoundingClientRect();
              const x = ((e.clientX - rect.left) / rect.width) * 100;
              const heart = createFallingHeart(x, 35, 2600 + Math.random() * 1000);
              e.currentTarget.appendChild(heart);
            }, { passive: true });

            document.addEventListener('keydown', (e) => {
              if (e.key.toLowerCase() === 'g') startGame();
              if (e.key.toLowerCase() === 'r') resetGame();
              if (e.key.toLowerCase() === 'h') {
                for (let i = 0; i < 5; i++) {
                  setTimeout(() => {
                    const x = Math.random() * 100;
                    const heart = createFallingHeart(x, 40, 4200 + Math.random() * 1600);
                    document.querySelector('.card').appendChild(heart);
                  }, i * 200);
                }
                showSecretMessage("¡Hearts! 💖 Presiona 'G' para jugar");
              }
            });

            for (let i = 0; i < 8; i++) {
              setTimeout(() => {
                const x = Math.random() * 100;
                const heart = createFallingHeart(x, 35, 4200 + Math.random() * 1600);
                document.querySelector('.card').appendChild(heart);
              }, i * 200);
            }

            initFloatingHearts();

            setTimeout(() => {
              showSecretMessage("Hice esto con mucho cariño mariana bienvenida <33");
            }, 1000);

            const bubble = document.getElementById('noteBubble');
            let isDragging = false;
            let offsetX = 0;
            let offsetY = 0;

            bubble.addEventListener('mousedown', (e) => {
              isDragging = true;
              offsetX = e.clientX - bubble.offsetLeft;
              offsetY = e.clientY - bubble.offsetTop;
              bubble.style.cursor = 'grabbing';
            });

            document.addEventListener('mouseup', () => {
              isDragging = false;
              bubble.style.cursor = 'grab';
            });

            document.addEventListener('mousemove', (e) => {
              if (!isDragging) return;
              moveBubble(e.clientX, e.clientY);
            });

            bubble.addEventListener('touchstart', (e) => {
              isDragging = true;
              const touch = e.touches[0];
              offsetX = touch.clientX - bubble.offsetLeft;
              offsetY = touch.clientY - bubble.offsetTop;
            });

            document.addEventListener('touchend', () => {
              isDragging = false;
            });

            document.addEventListener('touchmove', (e) => {
              if (!isDragging) return;
              const touch = e.touches[0];
              moveBubble(touch.clientX, touch.clientY);
            });

            function moveBubble(x, y) {
              let left = x - offsetX;
              let top = y - offsetY;
              left = Math.max(0, Math.min(window.innerWidth - bubble.offsetWidth, left));
              top = Math.max(0, Math.min(window.innerHeight - bubble.offsetHeight, top));
              bubble.style.left = left + 'px';
              bubble.style.top = top + 'px';
            }

            const bubble2 = document.getElementById('noteBubble2');
            let isDragging2 = false;
            let offsetX2 = 0;
            let offsetY2 = 0;

            bubble2.addEventListener('mousedown', (e) => {
              isDragging2 = true;
              offsetX2 = e.clientX - bubble2.offsetLeft;
              offsetY2 = e.clientY - bubble2.offsetTop;
              bubble2.style.cursor = 'grabbing';
            });

            document.addEventListener('mouseup', () => {
              isDragging2 = false;
              bubble2.style.cursor = 'grab';
            });

            document.addEventListener('mousemove', (e) => {
              if (!isDragging2) return;
              moveBubble2(e.clientX, e.clientY);
            });

            bubble2.addEventListener('touchstart', (e) => {
              isDragging2 = true;
              const touch = e.touches[0];
              offsetX2 = touch.clientX - bubble2.offsetLeft;
              offsetY2 = touch.clientY - bubble2.offsetTop;
            });

            document.addEventListener('touchend', () => {
              isDragging2 = false;
            });

            document.addEventListener('touchmove', (e) => {
              if (!isDragging2) return;
              const touch = e.touches[0];
              moveBubble2(touch.clientX, touch.clientY);
            });

            function moveBubble2(x, y) {
              let left = x - offsetX2;
              let top = y - offsetY2;
              left = Math.max(0, Math.min(window.innerWidth - bubble2.offsetWidth, left));
              top = Math.max(0, Math.min(window.innerHeight - bubble2.offsetHeight, top));
              bubble2.style.left = left + 'px';
              bubble2.style.top = top + 'px';
              bubble2.style.right = 'auto';
            }
          </script>
</body>

</html>
